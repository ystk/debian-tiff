Index: tiff-3.9.4-5+squeeze1/libtiff/tif_ojpeg.c
===================================================================
--- tiff-3.9.4-5+squeeze1.orig/libtiff/tif_ojpeg.c	2011-05-07 10:17:04.560277368 -0400
+++ tiff-3.9.4-5+squeeze1/libtiff/tif_ojpeg.c	2011-05-07 10:17:06.460777099 -0400
@@ -1537,7 +1537,6 @@
 		OJPEGReadSkip(sp,4);
 	else
 	{
-		/* TODO: probably best to also add check on allowed upper bound, especially x, may cause buffer overflow otherwise i think */
 		/* Y: Number of lines */
 		if (OJPEGReadWord(sp,&p)==0)
 			return(0);
@@ -1555,6 +1554,11 @@
 			TIFFErrorExt(tif->tif_clientdata,module,"JPEG compressed data indicates unexpected width");
 			return(0);
 		}
+		if ((uint32)p>sp->strile_width)
+		{
+			TIFFErrorExt(tif->tif_clientdata,module,"JPEG compressed data image width exceeds expected image width");
+			return(0);
+		}
 		sp->sof_x=p;
 	}
 	/* Nf: Number of image components in frame */
