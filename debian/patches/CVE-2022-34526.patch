From: Markus Koschany <apo@debian.org>
Date: Sun, 29 Jan 2023 17:51:17 +0100
Subject: CVE-2022-34526

Origin: https://gitlab.com/libtiff/libtiff/-/commit/275735d0354e39c0ac1dc3c0db2120d6f31d1990
---
 libtiff/tif_dirinfo.c | 3 +++
 1 file changed, 3 insertions(+)

--- a/libtiff/tif_dirinfo.c
+++ b/libtiff/tif_dirinfo.c
@@ -975,6 +975,9 @@ _TIFFCheckFieldIsValidForCodec(TIFF *tif
 	    default:
 		return 1;
 	}
+	if( !TIFFIsCODECConfigured(tif->tif_dir.td_compression) ) {
+		return 0;
+	}
 	/* Check if codec specific tags are allowed for the current
 	 * compression scheme (codec) */
 	switch (tif->tif_dir.td_compression) {
